<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
>
<h:head>
    <h:outputStylesheet name="estilos/styles.css" />

    <title>Lista de Salas</title>
</h:head>


<h:body>
    <h1>Lista de Salas</h1>

    <!-- Tabla de registros -->
    <h:form id="frmTabla">
        <h:dataTable value="#{frmSala.registros}" var="r" border="1">
            <!-- Columna: ID -->
            <h:column>
                <f:facet name="header">ID</f:facet>
                <h:outputText value="#{r.idSala}"/>
            </h:column>

            <!-- Columna: Sucursal -->
            <h:column>
                <f:facet name="header">Sucursal</f:facet>
                <h:outputText value="#{r.idSucursal.nombre}"/>
            </h:column>

            <!-- Columna: Nombre -->
            <h:column>
                <f:facet name="header">Nombre</f:facet>
                <h:outputText value="#{r.nombre}"/>
            </h:column>

            <!-- Columna: Estado -->
            <h:column>
                <f:facet name="header">Estado</f:facet>
                <h:outputText value="#{r.activo ? 'Activo' : 'Inactivo'}"/>
            </h:column>

            <!-- Columna: Observaciones -->
            <h:column>
                <f:facet name="header">Observaciones</f:facet>
                <h:outputText value="#{r.observaciones}"/>
            </h:column>

            <!-- Botón: Seleccionar -->
            <h:column>
                <f:facet name="header">Acción</f:facet>
                <h:commandButton value="Seleccionar"
                                 actionListener="#{frmSala.btnSeleccionarRegistroHandler(r.idSala)}">
                    <f:ajax render="pnlDetalle" execute="@form"/>
                </h:commandButton>
            </h:column>
        </h:dataTable>

        <!-- Botón: Nuevo -->
        <h:commandButton value="Nuevo"
                         actionListener="#{frmSala.btnNuevoHandler}"/>
    </h:form>

    <!-- Formulario para editar/crear -->
    <h:panelGroup id="pnlDetalle">
        <h:form id="frmDetalle" rendered="#{not empty frmSala.registro}">
            <h:panelGrid columns="2" cellpadding="5" border="1">
                <h:outputLabel value="ID" for="txtId"/>
                <h:inputText id="txtId" value="#{frmSala.registro.idSala}" readonly="true" disabled="true"/>

                <h:outputLabel value="Nombre" for="txtNombre"  />
                <h:inputText id="txtNombre" value="#{frmSala.registro.nombre}" size="50" required="true"/>

                <h:outputLabel value="Sucursal" for="lstSucursal"/>
                <h:selectOneMenu id="lstSucursal" value="#{frmSala.idSucursalSeleccionado}">
                    <f:selectItem itemValue="" itemLabel="Seleccione una sucursal" noSelectionOption="true"/>
                    <f:selectItems value="#{frmSala.listaSucursales}" var="s"
                                   itemLabel="#{s.nombre}" itemValue="#{s.idSucursal}"/>
                </h:selectOneMenu>

                <h:outputLabel value="Estado" for="chkActivo"/>
                <h:selectBooleanCheckbox id="chkActivo" value="#{frmSala.registro.activo}"/>

                <h:outputLabel value="Observaciones" for="txtObservaciones"/>
                <h:inputTextarea id="txtObservaciones" value="#{frmSala.registro.observaciones}" cols="50" rows="3"/>
            </h:panelGrid>

            <h:messages showSummary="true" showDetail="true"/>

            <h:panelGrid columns="4" cellpadding="5">
                <h:commandButton value="Guardar"
                                 actionListener="#{frmSala.btnGuardarHandler}"
                                 rendered="#{frmSala.estado == 'CREAR'}">
                    <f:ajax render="frmTabla pnlDetalle" execute="@form"/>
                </h:commandButton>

                <h:commandButton value="Modificar"
                                 actionListener="#{frmSala.btnGuardarHandler}"
                                 rendered="#{frmSala.estado == 'MODIFICAR'}">
                    <f:ajax render="frmTabla pnlDetalle" execute="@form"/>
                </h:commandButton>

                <h:commandButton value="Eliminar"
                                 actionListener="#{frmSala.btnEliminarHandler}"
                                 rendered="#{frmSala.estado == 'MODIFICAR'}">
                    <f:ajax render="frmTabla pnlDetalle" execute="@form"/>
                </h:commandButton>

                <h:commandButton value="Cancelar"
                                 actionListener="#{frmSala.btnCancelarHandler}">
                    <f:ajax render="frmTabla pnlDetalle" execute="@form"/>
                </h:commandButton>
            </h:panelGrid>
        </h:form>
    </h:panelGroup>
</h:body>
</html>
